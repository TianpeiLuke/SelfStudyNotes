---
tags:
  - concept
  - math/stochastic_process
  - math/functional_analysis
keywords:
  - measure_preserving_transformation
  - Markov_Chain
topics:
  - stochastic_process
  - functional_analysis
name: Measure Preserving Transformation in Markov Chain
date of note: 2024-06-23
---

## Concept Definition

>[!important]
>**Name**: Measure Preserving Transformation in Markov Chain

### Bernoulli Shift

>[!important] Definition
>Let $S$ be a *finite set*, and consider the space $S^{\infty}$ be *$\omega$-tuple* (i.e. the infinite sequence) of $S$. 
>$$
>S^{\infty} := \left\{ \omega := (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,): Z_{k}(\omega) \in S, k \ge 1 \right\} 
>$$
>where $Z_{k}: S^{\infty} \to S$ is the *coordinate mapping*. Note that $(Z_{1} \,{,}\ldots{,}\,)$ represents all *i.i.d. random variables* in $S$.
>
>- Define a **shift** $T$ of $\omega := (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,)$ by $$T\omega := (Z_{2}(\omega), Z_{3}(\omega) \,{,}\ldots{,}\,)$$ That is, $T$ shift remaining elements **to the left**. $$Z_{k}\left(T\omega\right) = Z_{k+1}(\omega), \quad k \ge 1.$$ 
>- Define a **probability mass function** on $S$ as $p: S \to [0,1]$ with $\sum_{x\in S} p_{x} = 1$. Then the *joint probability* on any finite-dimensional cylinder is determined uniquely by $$\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \prod_{i=1}^{n}p_{u_{i}}.$$ Thus the probability mass function extends to a **probability measure** $\mathcal{P}$ on *the $\sigma$-algebra $\mathscr{C}$ generated by cylinder sets*.
>
>It can be shown that the shift-transformation $T$ above is **$\mathcal{P}$-measure preserving** called the **Bernoulli shift**.

- [[Empirical Process and Empirical Measure]]
- [[Stochastic Process]]
- [[Measure Preserving Transformation]]

### Markov Shift


>[!important] Definition
>Let $S$ be a *finite set*. Let $$\boldsymbol{P} := \left[ p_{i,j} \right]_{i\in S \;,j \in S}$$ be a **stochastic matrix** i.e. $$\sum_{i\in S}p_{i,j} = 1,\, \quad \sum_{j\in S}p_{i,j} = 1.$$
>
>- Let $\pi_{i}$ be a *probability* on $S$. The  *joint probability* on any finite-dimensional cylinder is determined uniquely by $$\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \sum_{u_{1}\in H}\pi_{u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}}.$$ Follow the same argument as above, the probability measure $\mathcal{P}$ extends to a **probability measure** $\mathcal{P}$ on *the $\sigma$-algebra* $\mathscr{C} := \sigma(\mathscr{C}_{0})$.
>
>- This *probability measure* $\mathcal{P}$ is uniquely determined by the condition $$\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\, Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \pi_{u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}}$$ In other word, the coordinate functions $(Z_{n})$ are a **Markov chain** with *transition probabilities* $p_{i,j}$.
>- Define a **shift** $T$ of $\omega := (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,)$ by $$T\omega := (Z_{2}(\omega), Z_{3}(\omega) \,{,}\ldots{,}\,)$$ That is, $T$ shift remaining elements **to the left**. $$Z_{k}\left(T\omega\right) = Z_{k+1}(\omega), \quad k \ge 1.$$ 
>- Suppose that $\pi$ is an **invariant measure** of the Markov chain. $$\sum_{x\in S}\pi(x)\,p_{x, y} = \pi(y)$$
>
>It can be shown that the shift-transformation $T$ above is **$\mathcal{P}$-measure preserving** called the **Markov shift**.

- [[Markov Chain and Markov Process]]
- [[Markov Transition Kernel and Transition Function]]
- [[Invariant Measure and Stationary Distribution]]

### Semi-Group associated with Transition Function

![[Semigroup associated with Transition Function#^49c838]]

- [[Semigroup associated with Transition Function]]

>[!important]
>For **stationary** *Markov process* $(X_{t}, t\in T)$, the semi-group $\{ T_{s,t} \}$ becomes $\{ T_{t} \}$ where
>$$
>(T_{t}\,f)(x) = \mathbb{E}\left[  f(X_{t}) | X_{0} = x \right] = \mathbb{E}\left[  f(X_{t+h}) | X_{h} = x \right]\, \quad \forall h \in T
>$$
>
>We can show that $\{ T_{t}, t\in [0, \infty) \}$ is a sequence of **measure preserving transformations**.



## Proof

### Bernoulli Shift

>[!info] 
>Let $S$ be a *finite set*, and consider the space $S^{\infty}$ be *$\omega$-tuple* of $S$. 
>$$
>S^{\infty} := \left\{ (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,): Z_{k}(\omega) \in S, k \ge 1 \right\} 
>$$
>where $Z_{k}$ is the *coordinate mapping*, i.e. $(Z_{1} \,{,}\ldots{,}\,)$ are all *i.i.d. random variables*.
>
>Define the **shift** $T$ by
>$$
>T\omega := (Z_{2}(\omega), Z_{3}(\omega) \,{,}\ldots{,}\,)
>$$
>where $\omega := (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,)$. That is, $T$ shift remaining elements **to the left**.
>$$
>Z_{k}\left(T\omega\right) = Z_{k+1}(\omega), \quad k \ge 1.
>$$ 
>
>If $$A := \left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) \in H \right\}$$ is a *cylinder*, then
>$$
>\begin{align*}
>T^{-1}(A) &= \left\{ \omega: \left(Z_{2}(\omega) \,{,}\ldots{,}\,Z_{n+1}(\omega)\right) \in H \right\} \\
>&= \left\{ \omega: \left(Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,Z_{n+1}(\omega)\right) \in  S \times H\right\} 
>\end{align*}
>$$
>is another **cylinder**. Note that the $\sigma$-algebra $\mathscr{C}$ is generated by all cylinders, $T$ is **measurable**.
>
>We can define a **probability mass function** $p$ on $S$, that is, $$\sum_{x\in S}p(x) =1,\; p(x) \ge 0, \forall x\in S.$$  This probability  $p(x)$ defines a **product probability measure** $\mathcal{P}$ on the **boolean field** $\mathscr{C}_{0}$ generated by *all cylinder sets*. Since $\mathcal{P}$ is consistently defined, and countably additive, it *extends to* a probability measure on $\mathscr{C} := \sigma(\mathscr{C}_{0})$.
>
>Since the *thin cylinders* $$\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} $$ forms a *$\pi$-system* that generates $\mathscr{C}$, $\mathcal{P}$ is completely determined by the probabilities assigned to them:
>$$
>\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \prod_{i=1}^{n}p_{u_{i}}.
>$$
>The set on the left is a *thin cylinder* $A\in \mathscr{C}_{0}$, then 
>$$
>\begin{align*}
>\mathcal{P}\left(T^{-1}A\right) &= \mathcal{P}\left\{ \omega: \left(Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,Z_{n+1}(\omega)\right) \in  S \times H \right\} \\
>&= \sum_{u \in S}\,p_{u}\prod_{i=1}^{n}p_{u_{i}}\\
>&= \prod_{i=1}^{n}p_{u_{i}}\\
>&= \mathcal{P}(A).
>\end{align*}
>$$
>It follows by the lemma in [[Measure Preserving Transformation]] that $T$ preserves $\mathcal{P}$.
>
>This shift transformation $T$ is called **the Bernoulli shift**.

- [[omega Tuples]]
- [[Stochastic Process]]
- [[Probability and Measure by Billingsley]] pp 311
- [[Measure Preserving Transformation]]

### Markov Shift

>[!info]
>Let $S$ be a *finite set*. Let $$\boldsymbol{P} := \left[ p_{i,j} \right]_{i\in S \;,j \in S}$$ be a **stochastic matrix** i.e. $$\sum_{j\in S}p_{i,j} = 1.$$
>
>Let $\pi_{i}$ be a *probability* on $S$. The  *joint probability* on any finite-dimensional cylinder is determined uniquely by $$\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\,Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \sum_{u_{1}\in H}\pi_{u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}}.$$ 
>
>Follow the same argument as above, the product probability measure $\mathcal{P}$ is consistently defined and *finitely additive*, which carries over to the new measure, since the rows of transition matrix add to $1$. 
>$$
>\sum_{u_{n+1} \,{,}\ldots{,}\,u_{m}}p_{u_{n}, u_{n+1}}\cdots p_{u_{m-1}, u_{m}} = 1
>$$
>Thus the probability $\mathcal{P}$ is *countably additive* on boolean algebra $\mathscr{C}_{0}$, and so it extends to a **probability measure** $\mathcal{P}$ on *the $\sigma$-algebra* $\mathscr{C} := \sigma(\mathscr{C}_{0})$.
>
>This *probability measure* $\mathcal{P}$ is uniquely determined by the condition
>$$
>\mathcal{P}\left\{ \omega: \left(Z_{1}(\omega) \,{,}\ldots{,}\, Z_{n}(\omega)\right) = (u_{1} \,{,}\ldots{,}\,u_{n}) \right\} = \pi_{u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}} 
>$$
>In other word, the coordinate functions $(Z_{n})$ are a **Markov chain** with *transition probabilities* $p_{i,j}$.
>
>Define a **shift** $T$ of $\omega := (Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,)$ by $$T\omega := (Z_{2}(\omega), Z_{3}(\omega) \,{,}\ldots{,}\,)$$ That is, $T$ shift remaining elements **to the left**. $$Z_{k}\left(T\omega\right) = Z_{k+1}(\omega), \quad k \ge 1.$$ 
>
>Suppose that $\pi$ is an **invariant measure** of the Markov chain. $$\sum_{x\in S}\pi(x)\,p_{x, y} = \pi(y)$$
>Then 
>$$
>\begin{align*}
>\mathcal{P}\left(T^{-1}A\right) &= \mathcal{P}\left\{ \omega: \left(Z_{1}(\omega), Z_{2}(\omega) \,{,}\ldots{,}\,Z_{n+1}(\omega)\right) \in  S \times H \right\} \\
>&= \sum_{u\in S}\pi_{u}p_{u,u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}}\\
>&= \pi_{u_{1}}\prod_{i=1}^{n}p_{u_{i},u_{i+1}}\\
>&= \mathcal{P}(A).
>\end{align*}
>$$
>It follows by the lemma in [[Measure Preserving Transformation]] that $T$ preserves $\mathcal{P}$.
>
>This shift transformation $T$ is called **the Markov shift**.

- [[Markov Chain and Markov Process]]
- [[Markov Transition Kernel and Transition Function]]




-----------
##  Recommended Notes and References

- [[Measure Preserving Transformation]]
- [[Invariant Measure and Stationary Distribution]]

- [[Markov Transition Kernel and Transition Function]]
- [[Markov Chain and Markov Process]]


- [[Probability and Measure by Billingsley]] pp 313